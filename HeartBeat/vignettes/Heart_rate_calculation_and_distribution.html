<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Emil Plesnik, Marand d.o.o." />

<meta name="date" content="2015-10-07" />

<title>Heart rate calculation and distribution</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amargin%2Dleft%3A210px%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Aposition%3A%20fixed%3B%0Aleft%3A%200%3B%0Atop%3A%2050px%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20200px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0Aoverflow%3Aauto%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0A%7D%0Apre%20%7B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Heart rate calculation and distribution</h1>
<h4 class="author"><em>Emil Plesnik, Marand d.o.o.</em></h4>
<h4 class="date"><em>2015-10-07</em></h4>
</div>

<div id="TOC">
<h2 class="toctitle">Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#heart-rate-calculation">Heart rate calculation</a></li>
<li><a href="#non-training-heart-rate-distribution">Non-training heart rate distribution</a></li>
<li><a href="#training-heart-rate-distribution">Training heart rate distribution</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This is the second of three short tutorials on how to use the package <code>heartBeat</code> for heart beat detection from single-lead ECG signals. It presents in more detail the use and workflow of the <code>HRdistribution</code> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">HRdistribution &lt;-<span class="st"> </span>function(Rall, signal, HRrest, age, <span class="dt">training =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>with input arguments:</p>
<ul>
<li><code>Rall</code>: data frame with information about (detected) heart beats with columns:
<ul>
<li><code>Rtrue_idx</code>: the indexes of R peaks in signal,</li>
<li><code>Rtrue_sec</code>: the time moments of Rtrue_idx in seconds,</li>
<li><code>RtoRext</code>: R-R intervals in number of samples (with the starting zero),</li>
<li><code>RtoR_secext</code>: R-R intervals in seconds (with the starting zero),</li>
</ul></li>
<li><code>signal</code>: vector of ECG signal data points (the ECG signal from which the heart beats were determined),</li>
<li><code>HRrest</code>: numeric value of the monitored person’s resting heart rate,</li>
<li><code>age</code>: numeric value of age of the monitored person’s age,</li>
<li><code>training</code>: a flag indicating, whether the monitored person was on trainning/exercise or not.</li>
</ul>
<p>The function reads the signal and the output of <code>heart_beat</code> function and determines instant heart rates, their distribution and a basic histogram. The output of the function is a matrix named <code>beat_matrix</code> with 16 or 4 columns. Each column corresponds to a certain heart rate interval. The number of columns depends on the setting of the <code>training</code> flag: if <code>training</code> is <code>FALSE</code>, 16 columns are returned and if <code>training</code> is <code>TRUE</code>, 4 columns are returned. Each column contains indexes of all heart beats that belong to the certain interval. The number of rows in the <code>beat_matrix</code> is determined by the heart rate interval with the most heart beats. All other columns with less heart beats are appropriately filled with <code>NA</code> values.</p>
</div>
<div id="heart-rate-calculation" class="section level2">
<h2>Heart rate calculation</h2>
<p>The function begins with basic preparation of the input data. First, the sampling frequency is calculated from the sample index and time moment of one of the detected heart beats. The calculation is prepared to return the result in Hz and is rounded to the whole number (in this example it should be equal to 250 Hz). Also, the instant heart rate in beats per minute is calculated</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Rall.Rda&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;heartBeat&quot;</span>))

<span class="co"># Calculate sampling rate</span>
SampleFreq &lt;-<span class="st"> </span><span class="kw">round</span>(Rall$Rtrue_idx[<span class="dv">2</span>] /<span class="st"> </span>Rall$Rtrue_sec[<span class="dv">2</span>], -<span class="dv">1</span>)
SampleFreq</code></pre></div>
<pre><code>## [1] 250</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate instant heart rate IHR. The padded zero at the begining is left out.</span>
IHR &lt;-<span class="st"> </span><span class="dv">60</span> /<span class="st"> </span>Rall$RtoR_secext[-<span class="dv">1</span>]
IHR</code></pre></div>
<pre><code>## [1] 72.81553 73.71007 73.71007 73.98274 73.80074 73.26007 72.46377 72.81553</code></pre>
</div>
<div id="non-training-heart-rate-distribution" class="section level2">
<h2>Non-training heart rate distribution</h2>
<p>Then the heart rate distribution is determined. Based on the setting of the <code>training</code> flag there are two options that produce distributions with different number and limits of heart rate intervals. When the <code>training</code> flag is set to <code>FALSE</code> the heart rate values are divided into intervals from below 60 to above 200 with the stepping of 10 beats. For each interval a vector is created into which the indexes of all instant heart beats are written. These vectors remain empty if there are no beats in the corresponding interval. In our example all the detected heart beats fall into the interval between 70 and 80 beats per minute (<code>ind_70_80</code>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">training &lt;-<span class="st"> </span><span class="ot">TRUE</span>

<span class="co"># Determine indexes of heart beats which are in limits of intervals - divide</span>
<span class="co"># beats into interval groups</span>
ind_sub_60 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &lt;<span class="st"> </span><span class="dv">60</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_60_70 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">60</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">70</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_70_80 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">70</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">80</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_80_90 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">80</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">90</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_90_100 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">90</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">100</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_100_110 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">100</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">110</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_110_120 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">110</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">120</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_120_130 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">120</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">130</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_130_140 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">130</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">140</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_140_150 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">140</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">150</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_150_160 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">150</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">160</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_160_170 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">160</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">170</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_170_180 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">170</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">180</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_180_190 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">180</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">190</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_190_200 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">190</span> &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span><span class="dv">200</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_above_200 &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span><span class="dv">200</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)

ind_70_80</code></pre></div>
<pre><code>## [1] 1 2 3 4 5 6 7 8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ind_60_70</code></pre></div>
<pre><code>## integer(0)</code></pre>
<p>Heart beats in each vector are counted and ploted as a histogram</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beats_count &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(ind_sub_60), <span class="kw">length</span>(ind_60_70), <span class="kw">length</span>(ind_70_80),
                     <span class="kw">length</span>(ind_80_90), <span class="kw">length</span>(ind_90_100), <span class="kw">length</span>(ind_100_110),
                     <span class="kw">length</span>(ind_110_120), <span class="kw">length</span>(ind_120_130),
                     <span class="kw">length</span>(ind_130_140), <span class="kw">length</span>(ind_140_150),
                     <span class="kw">length</span>(ind_150_160), <span class="kw">length</span>(ind_160_170),
                     <span class="kw">length</span>(ind_170_180), <span class="kw">length</span>(ind_180_190),
                     <span class="kw">length</span>(ind_190_200), <span class="kw">length</span>(ind_above_200))
beats_count</code></pre></div>
<pre><code>##  [1] 0 0 8 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(beats_count, <span class="dt">main =</span> <span class="st">&quot;HR Histogram&quot;</span>, 
        <span class="dt">xlab =</span> <span class="st">&quot;HR range&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Total&quot;</span>, 
        <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;&lt; 60&quot;</span>,<span class="st">&quot;60-70&quot;</span>,<span class="st">&quot;70-80&quot;</span>,<span class="st">&quot;80-90&quot;</span>,<span class="st">&quot;90-100&quot;</span>, 
                    <span class="st">&quot;100-110&quot;</span>, <span class="st">&quot;110-120&quot;</span>, <span class="st">&quot;120-130&quot;</span>, 
                    <span class="st">&quot;130-140&quot;</span>, <span class="st">&quot;140-150&quot;</span>, <span class="st">&quot;150-160&quot;</span>,
                    <span class="st">&quot;160-170&quot;</span>, <span class="st">&quot;170-180&quot;</span>, <span class="st">&quot;180-190&quot;</span>,
                    <span class="st">&quot;190-200&quot;</span>, <span class="st">&quot;&gt; 200&quot;</span>), 
        <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
<p>Finally, the function output is constructed: the data frame with all heart beats of the input ECG signal. Columns of this data frame corespond to heart rate intervals and in each column the indexes of all heart beats that belong to the certain interval are writen. However, due to the variability of heart function there are different numbers of heart beats in each interval. Consequently, the “interval” vectors (<code>ind_..._...</code>) have different lengths and are easier to combine into a list than into a data frame. This is why in first step the list of interval vectors of unequal lengths is created (<code>beat_list</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beat_list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ind_sub_60 =</span> ind_sub_60, <span class="dt">ind_60_70 =</span> ind_60_70,
                      <span class="dt">ind_70_80 =</span> ind_70_80, <span class="dt">ind_80_90 =</span> ind_80_90,
                      <span class="dt">ind_90_100 =</span> ind_90_100, <span class="dt">ind_100_110 =</span> ind_100_110,
                      <span class="dt">ind_110_120 =</span> ind_110_120, <span class="dt">ind_120_130 =</span> ind_120_130,
                      <span class="dt">ind_130_140 =</span> ind_130_140, <span class="dt">ind_140_150 =</span> ind_140_150,
                      <span class="dt">ind_150_160 =</span> ind_150_160, <span class="dt">ind_160_170 =</span> ind_160_170,
                      <span class="dt">ind_170_180 =</span> ind_170_180, <span class="dt">ind_180_190 =</span> ind_180_190,
                      <span class="dt">ind_190_200 =</span> ind_190_200, <span class="dt">ind_above_200 =</span> ind_above_200)
<span class="kw">str</span>(beat_list)</code></pre></div>
<pre><code>## List of 16
##  $ ind_sub_60   : int(0) 
##  $ ind_60_70    : int(0) 
##  $ ind_70_80    : int [1:8] 1 2 3 4 5 6 7 8
##  $ ind_80_90    : int(0) 
##  $ ind_90_100   : int(0) 
##  $ ind_100_110  : int(0) 
##  $ ind_110_120  : int(0) 
##  $ ind_120_130  : int(0) 
##  $ ind_130_140  : int(0) 
##  $ ind_140_150  : int(0) 
##  $ ind_150_160  : int(0) 
##  $ ind_160_170  : int(0) 
##  $ ind_170_180  : int(0) 
##  $ ind_180_190  : int(0) 
##  $ ind_190_200  : int(0) 
##  $ ind_above_200: int(0)</code></pre>
<p>A data frame can still not be created because the function <code>as.data.frame</code> errors out. Therefore, in the second step a list of vectors of equal lengths (<code>beat_data</code>) is created by using the function <code>lapply</code>. The <code>&quot;[&quot;</code> argument means that the <code>lapply</code> is applying the indexing operator on the elements of the <code>beat_list</code> sorting them into a list where all elements have the length of the interval vector with the most heart beats (<code>max(beats_count)</code>). All elements of the <code>beat_list</code> with lesser number of heart beats than the <code>max(beats_count)</code> are complemented with <code>NA</code> values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beat_data &lt;-<span class="st"> </span><span class="kw">lapply</span>(beat_list, <span class="st">&quot;[&quot;</span>, <span class="kw">seq</span>(<span class="kw">max</span>(beats_count)))
<span class="kw">str</span>(beat_data)</code></pre></div>
<pre><code>## List of 16
##  $ ind_sub_60   : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_60_70    : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_70_80    : int [1:8] 1 2 3 4 5 6 7 8
##  $ ind_80_90    : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_90_100   : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_100_110  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_110_120  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_120_130  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_130_140  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_140_150  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_150_160  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_160_170  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_170_180  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_180_190  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_190_200  : int [1:8] NA NA NA NA NA NA NA NA
##  $ ind_above_200: int [1:8] NA NA NA NA NA NA NA NA</code></pre>
<p>The data frame <code>beat_matrix</code>, which is returned as output, is created in the third step by applying <code>data.frame</code> function on the list of vectors of equal lengths <code>beat_data</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beat_matrix &lt;-<span class="st"> </span><span class="kw">data.frame</span>(beat_data)
<span class="kw">str</span>(beat_matrix)</code></pre></div>
<pre><code>## 'data.frame':    8 obs. of  16 variables:
##  $ ind_sub_60   : int  NA NA NA NA NA NA NA NA
##  $ ind_60_70    : int  NA NA NA NA NA NA NA NA
##  $ ind_70_80    : int  1 2 3 4 5 6 7 8
##  $ ind_80_90    : int  NA NA NA NA NA NA NA NA
##  $ ind_90_100   : int  NA NA NA NA NA NA NA NA
##  $ ind_100_110  : int  NA NA NA NA NA NA NA NA
##  $ ind_110_120  : int  NA NA NA NA NA NA NA NA
##  $ ind_120_130  : int  NA NA NA NA NA NA NA NA
##  $ ind_130_140  : int  NA NA NA NA NA NA NA NA
##  $ ind_140_150  : int  NA NA NA NA NA NA NA NA
##  $ ind_150_160  : int  NA NA NA NA NA NA NA NA
##  $ ind_160_170  : int  NA NA NA NA NA NA NA NA
##  $ ind_170_180  : int  NA NA NA NA NA NA NA NA
##  $ ind_180_190  : int  NA NA NA NA NA NA NA NA
##  $ ind_190_200  : int  NA NA NA NA NA NA NA NA
##  $ ind_above_200: int  NA NA NA NA NA NA NA NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## return(beat_matrix)</code></pre></div>
</div>
<div id="training-heart-rate-distribution" class="section level2">
<h2>Training heart rate distribution</h2>
<p>When the <code>training</code> flag is set to <code>TRUE</code>, the algorithm uses a different division of heart rate intervals than the non-training regime. All other steps are equivalent. During trainig the values of heart beats are expected to be higher than the interval distribution of non-training conditions. Also, training is divided into known specific heart rate zones<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> calculated according to estimated maximum heart rate of the trainee. Therefore, the <a href="https://en.wikipedia.org/wiki/Heart_rate#Maximum_heart_rate">maximum heart rate</a> estimation is the required first step and can be determined in various ways. In this example, the maximum heart rate is calculated by using the following age-predicted formula<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">age &lt;-<span class="st"> </span><span class="dv">30</span>
HRmax &lt;-<span class="st"> </span><span class="fl">205.8</span> -<span class="st"> </span>(<span class="fl">0.685</span> *<span class="st"> </span>age)
HRmax</code></pre></div>
<pre><code>## [1] 185.25</code></pre>
<p>which proved as “the most accurate general equation”<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>. This is why the age of the monitored person is one of the input arguments. The limits of heart rate training zones are then calculated by applying the Karvonen formula<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>: <code>Morning Resting Heart Rate + (Maximum heart rate - Morning Resting Heart Rate) * percentage</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">HRrest &lt;-<span class="st"> </span><span class="dv">60</span>

recovery_lim &lt;-<span class="st"> </span><span class="kw">c</span>(HRrest +<span class="st"> </span>((HRmax-HRrest)*<span class="fl">0.6</span>), HRrest +<span class="st"> </span>((HRmax-HRrest)*<span class="fl">0.7</span>))
aerobic_lim &lt;-<span class="st"> </span><span class="kw">c</span>(HRrest +<span class="st"> </span>((HRmax-HRrest)*<span class="fl">0.7</span>), HRrest +<span class="st"> </span>((HRmax-HRrest)*<span class="fl">0.8</span>))
anaerobic_lim &lt;-<span class="st"> </span><span class="kw">c</span>(HRrest +<span class="st"> </span>((HRmax-HRrest)*<span class="fl">0.8</span>), HRrest +<span class="st"> </span>((HRmax-HRrest)*<span class="fl">0.9</span>))
red_lim &lt;-<span class="st"> </span><span class="kw">c</span>(HRrest +<span class="st"> </span>((HRmax-HRrest)*<span class="fl">0.9</span>),HRrest +<span class="st"> </span>((HRmax-HRrest)*<span class="dv">1</span>))

<span class="kw">list</span>(<span class="dt">recovery_lim =</span> recovery_lim, <span class="dt">aerobic_lim =</span> aerobic_lim, 
     <span class="dt">anaerobic_lim =</span> anaerobic_lim, <span class="dt">red_lim =</span> red_lim)</code></pre></div>
<pre><code>## $recovery_lim
## [1] 135.150 147.675
## 
## $aerobic_lim
## [1] 147.675 160.200
## 
## $anaerobic_lim
## [1] 160.200 172.725
## 
## $red_lim
## [1] 172.725 185.250</code></pre>
<p>Then the heart beats from <code>IHR</code> are distributed according to the calculated limits of training heart rate zones by applying the same technique as for the non-training regime</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># IHR correction performed just to get the data into range of calculated limits</span>
IHR &lt;-<span class="st"> </span>IHR +<span class="st"> </span><span class="dv">87</span>

ind_recovery &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span>recovery_lim[<span class="dv">1</span>] &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span>recovery_lim[<span class="dv">2</span>], <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_aerobic &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span>aerobic_lim[<span class="dv">1</span>] &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span>aerobic_lim[<span class="dv">2</span>], <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_anaerobic &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span>anaerobic_lim[<span class="dv">1</span>] &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span>anaerobic_lim[<span class="dv">2</span>], <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
ind_red &lt;-<span class="st"> </span><span class="kw">which</span>(IHR &gt;=<span class="st"> </span>red_lim[<span class="dv">1</span>] &amp;<span class="st"> </span>IHR &lt;<span class="st"> </span>red_lim[<span class="dv">2</span>], <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)

<span class="kw">list</span>(<span class="dt">ind_recovery =</span> ind_recovery, <span class="dt">ind_aerobic =</span> ind_aerobic, 
     <span class="dt">ind_anaerobic =</span> ind_anaerobic, <span class="dt">ind_red =</span> ind_red)</code></pre></div>
<pre><code>## $ind_recovery
## integer(0)
## 
## $ind_aerobic
## [1] 1 7 8
## 
## $ind_anaerobic
## [1] 2 3 4 5 6
## 
## $ind_red
## integer(0)</code></pre>
<p>Heart beats in each vector are counted and ploted as a histogram</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beats_training &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(ind_recovery), <span class="kw">length</span>(ind_aerobic),
                        <span class="kw">length</span>(ind_anaerobic), <span class="kw">length</span>(ind_red))
beats_training</code></pre></div>
<pre><code>## [1] 0 3 5 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graphics::<span class="kw">barplot</span>(beats_training, <span class="dt">main =</span> <span class="st">&quot;HR Histogram - Training&quot;</span>,
                  <span class="dt">xlab =</span> <span class="st">&quot;HR range&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Total&quot;</span>,
                  <span class="dt">names.arg =</span> <span class="kw">c</span>(<span class="st">&quot;Recovery&quot;</span>,<span class="st">&quot;Aerobic&quot;</span>,<span class="st">&quot;Anaerobic&quot;</span>,<span class="st">&quot;Red Line&quot;</span>),
                  <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
<p>The function output is constructed Similarly as with the non-training regime. A list (<code>beat_list</code>) of interval vectors is created, where each interval vector contains the indexes of heart beats that correspond to the certain heart rate zone. The interval vectors in <code>beat_list</code> are first complemented to be of equal length (the <code>lapply</code> line) and then the list <code>beat_data</code> (with interval vectors of equal length) is converted to a data frame <code>beat_matrix</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beat_list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ind_recovery =</span> ind_recovery, <span class="dt">ind_aerobic =</span> ind_aerobic,
                  <span class="dt">ind_anaerobic =</span> ind_anaerobic, <span class="dt">ind_red =</span> ind_red)

beat_data &lt;-<span class="st"> </span><span class="kw">lapply</span>(beat_list, <span class="st">'['</span>, <span class="kw">seq</span>(<span class="kw">max</span>(beats_count)))
beat_matrix &lt;-<span class="st"> </span><span class="kw">data.frame</span>(beat_data)
<span class="kw">str</span>(beat_matrix)</code></pre></div>
<pre><code>## 'data.frame':    8 obs. of  4 variables:
##  $ ind_recovery : int  NA NA NA NA NA NA NA NA
##  $ ind_aerobic  : int  1 7 8 NA NA NA NA NA
##  $ ind_anaerobic: int  2 3 4 5 6 NA NA NA
##  $ ind_red      : int  NA NA NA NA NA NA NA NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## return(beat_matrix)</code></pre></div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="http://www.brianmac.co.uk/hrm1.htm">Heart Rate Training Zones</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Inbar, O. Oten, A., Scheinowitz, M., Rotstein, A., Dlin, R. and Casaburi, R. Normal cardiopulmonary responses during incremental exercise in 20 - 70-yr-old men. Med Sci Sport Exerc 1994;26(5):538-546.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Robergs R and Landwehr R (2002). “The Surprising History of the ‘HRmax=220-age’ Equation” (PDF). Journal of Exercise Physiology 5 (2): 1–10.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p><a href="http://www.polar.com/us-en/support/How_to_calculate_target_heart_rate_zone_">Polar: How to calculate target heart rate zone?</a><a href="#fnref4">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
