<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Emil Plesnik, Marand d.o.o." />

<meta name="date" content="2015-10-07" />

<title>Heart beat detection from single-lead ECG signal</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amargin%2Dleft%3A210px%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Aposition%3A%20fixed%3B%0Aleft%3A%200%3B%0Atop%3A%2050px%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20200px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0Aoverflow%3Aauto%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0A%7D%0Apre%20%7B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Heart beat detection from single-lead ECG signal</h1>
<h4 class="author"><em>Emil Plesnik, Marand d.o.o.</em></h4>
<h4 class="date"><em>2015-10-07</em></h4>
</div>

<div id="TOC">
<h2 class="toctitle">Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#heart-beat-detection">Heart beat detection</a><ul>
<li><a href="#wavelet-decomposition">Wavelet decomposition</a></li>
<li><a href="#peak-detection">Peak detection</a></li>
<li><a href="#determining-heart-beats">Determining heart beats</a></li>
<li><a href="#calculate-r-r-intervals">Calculate R-R intervals</a></li>
<li><a href="#heart-beat-tachogram">Heart beat tachogram</a></li>
<li><a href="#preparing-and-saving-output">Preparing and saving output</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This is the first of three short tutorials on how to use the package <code>heartBeat</code> for heart beat detection from single-lead ECG signals. The functions of the package are focused on the detection itself and it is asumed that the input ECG data is already preprocessed (parsed, imported, denoised, etc.). The ECG data is expected to be already loaded into a data frame and ready to use (for importing data recorded with Zephyr BioHarness 3 monitor, please see the package <code>zephyrECG</code>).<br />
However, for example purposes there is a data sample prepared within this package in the folder <code>./inst/extdata</code>. It is a data frame saved in .Rda format which can be imported with the <code>load</code> function. The data is loaded directly into a data frame called <code>ecg</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;ecg.Rda&quot;</span>, <span class="dt">package=</span><span class="st">&quot;heartBeat&quot;</span>))
<span class="kw">str</span>(ecg) </code></pre></div>
<pre><code>## 'data.frame':    2000 obs. of  2 variables:
##  $ time: num  1.41e+12 1.41e+12 1.41e+12 1.41e+12 1.41e+12 ...
##  $ ecg : int  502 506 507 507 506 506 506 506 506 507 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(<span class="dt">data =</span> ecg, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> ecg)) +<span class="st"> </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
<p>The data frame <code>ecg</code> has two columns:</p>
<ul>
<li><code>time</code>: UNIX timestamps with milisecond precision,</li>
<li><code>ecg</code>: ECG amplitudes (integer values).</li>
</ul>
<p>Once the data is loaded, we can start the analysis by detecting the heart beats with the function <code>heart_beat</code>. Based on this detection heart rate and its distribution can be determined by the <code>HRdistribution</code> function for the entire recording. Finally, all ECG data points can be color coded (tagged) according to the heart rate by applying the function <code>annotateHR</code>.<br />
Of course you can also analyze your own ECG data. It can be loaded in any way using any R compatible tools (e.g. the <code>zephyrECG</code> package) as long as it is ordered in a two-column data frame with column names the same as described above. This tutorial presents the workflow of the <code>heart_beat</code> function.</p>
</div>
<div id="heart-beat-detection" class="section level2">
<h2>Heart beat detection</h2>
<p>Heart beats are detected by performing wavelet analysis to the ECG data (time series) within the function <code>heart_beat</code> called with the following input arguments:</p>
<ul>
<li>data: Data frame with ECG data.</li>
<li>SampleFreq: The sampling frequency in Hz of ECG data. The default setting is 250 Hz.</li>
<li>thr: Fixed threshold value used to detect heart beats from wavelet coefficients. The default value is 9.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heart_beat &lt;-<span class="st"> </span>function(data, <span class="dt">SampleFreq =</span> <span class="dv">250</span>, <span class="dt">thr =</span> <span class="dv">9</span>){...}</code></pre></div>
<div id="wavelet-decomposition" class="section level3">
<h3>Wavelet decomposition</h3>
<p>Within the function <code>heart_beat</code> the detection is performed using <a href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform">discrete wavelet transform (DWT)</a> of ECG signal. The DWT of a signal <span class="math inline">\(x\)</span> is calculated by passing it through a series of filters. The signal samples are simultaneously passed through a low pass filter and a high-pass filter. The outputs from the high-pass filter give the detail coefficients and the outputs from the low-pass filter give the approximation coefficients. However, since half the frequencies of the signal have now been removed, half the samples can be discarded according to Nyquist’s rule. The filter outputs are then subsampled by 2 which concludes one level of wavelet decomposition. This decomposition has halved the time resolution since only half of each filter output characterises the signal. However, each output has half the frequency band of the input so the frequency resolution has been doubled. This decomposition is repeated to further increase the frequency resolution and the approximation coefficients (output of low-pass filtering) decomposed with high and low pass filters and then down-sampled. In our case 4-th level decomposition is determined using the <a href="https://en.wikipedia.org/wiki/Daubechies_wavelet">Daubechie wavelet</a> “d4” as the mother wavelet.<br />
The wavelet transform is calculated using the <code>dwt</code> function from the <code>wavelets</code> package. To ensure that the mentioned function is used the <code>RHRV</code> and <code>waveslim</code> packages are detached first (if loaded). Before performing wavelet transform, <code>NA</code> values are removed from the data and the time column is replaced with the column of row indexes of (non-NA) data samples. The data with removed <code>NA</code> values and corresponding indexes is sorted into a new data frame <code>df</code> with columns <code>idx</code> and <code>ecg</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SampleFreq &lt;-<span class="st"> </span><span class="dv">250</span>
thr &lt;-<span class="st"> </span><span class="dv">9</span>

<span class="co"># 4-level decomposition is used with the Daubechie d4 wavelet.</span>
wavelet &lt;-<span class="st"> &quot;d4&quot;</span>
level &lt;-<span class="st"> </span>4L

<span class="co"># If active detach packages RHRV and waveslim.</span>

if (!<span class="kw">is.na</span>(<span class="kw">match</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="kw">search</span>() ==<span class="st"> &quot;package:RHRV&quot;</span>))) {
    <span class="kw">detach</span>(<span class="st">&quot;package:RHRV&quot;</span>, <span class="dt">unload =</span> <span class="ot">TRUE</span>)
}
if (!<span class="kw">is.na</span>(<span class="kw">match</span>(<span class="st">&quot;TRUE&quot;</span>, <span class="kw">search</span>() ==<span class="st"> &quot;package:waveslim&quot;</span>))) {
    <span class="kw">detach</span>(<span class="st">&quot;package:waveslim&quot;</span>, <span class="dt">unload =</span> <span class="ot">TRUE</span>)
}

df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(ecg$ecg)), <span class="dt">ncol =</span> <span class="dv">2</span>))
<span class="kw">names</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;idx&quot;</span>, <span class="st">&quot;ecg&quot;</span>)
df$idx &lt;-<span class="st"> </span><span class="kw">which</span>(!<span class="kw">is.na</span>(ecg$ecg))
df$ecg &lt;-<span class="st"> </span>ecg$ecg[df$idx]

<span class="kw">str</span>(df)</code></pre></div>
<pre><code>## 'data.frame':    2000 obs. of  2 variables:
##  $ idx: int  1 2 3 4 5 6 7 8 9 10 ...
##  $ ecg: int  502 506 507 507 506 506 506 506 506 507 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(df$ecg)

<span class="kw">library</span>(wavelets)
ecg_wav &lt;-<span class="st"> </span><span class="kw">dwt</span>(X, <span class="dt">filter =</span> wavelet, <span class="dt">n.levels =</span> level, <span class="dt">boundary =</span> <span class="st">&quot;periodic&quot;</span>, 
    <span class="dt">fast =</span> <span class="ot">TRUE</span>)
<span class="kw">str</span>(ecg_wav)</code></pre></div>
<pre><code>## Formal class 'dwt' [package &quot;wavelets&quot;] with 11 slots
##   ..@ W         :List of 4
##   .. ..$ W1: num [1:1000, 1] 1.25 1.58 3.54e-01 -2.84e-14 -1.29e-01 ...
##   .. ..$ W2: num [1:500, 1] 1.0368 3.0858 -0.3538 0.0792 0.0458 ...
##   .. ..$ W3: num [1:250, 1] 1.1407 0.8128 1.0953 0.4334 0.0458 ...
##   .. ..$ W4: num [1:125, 1] 1.082 0.257 -3.861 6.176 0.677 ...
##   ..@ V         :List of 4
##   .. ..$ V1: num [1:1000, 1] 712 717 716 716 716 ...
##   .. ..$ V2: num [1:500, 1] 1010 1013 1013 1016 1016 ...
##   .. ..$ V3: num [1:250, 1] 1430 1434 1438 1441 1452 ...
##   .. ..$ V4: num [1:125, 1] 2025 2035 2059 2074 2025 ...
##   ..@ filter    :Formal class 'wt.filter' [package &quot;wavelets&quot;] with 7 slots
##   .. .. ..@ L        : int 4
##   .. .. ..@ level    : int 1
##   .. .. ..@ h        : num [1:4] -0.129 -0.224 0.837 -0.483
##   .. .. ..@ g        : num [1:4] 0.483 0.837 0.224 -0.129
##   .. .. ..@ wt.class : chr &quot;Daubechies&quot;
##   .. .. ..@ wt.name  : chr &quot;d4&quot;
##   .. .. ..@ transform: chr &quot;dwt&quot;
##   ..@ level     : int 4
##   ..@ n.boundary: num [1:4] 1 2 2 2
##   ..@ boundary  : chr &quot;periodic&quot;
##   ..@ series    : num [1:2000, 1] 502 506 507 507 506 506 506 506 506 507 ...
##   ..@ class.X   : chr &quot;numeric&quot;
##   ..@ attr.X    : list()
##   ..@ aligned   : logi FALSE
##   ..@ coe       : logi FALSE</code></pre>
<p>The result of <code>dwt</code> function is a discrete wavelet transform object <code>ecg_wav</code> with the detail and approximation coefficients stored as lists along with selected options and mother wavelet properties. Detail coefficients <code>W2</code> were selected for heart beat detection with fixed threshold. Below are the plots of detail coefficients <code>W1</code> - <code>W4</code> and the plots of approximation coefficients <code>V1</code> - <code>V4</code> to illustrate why this choice was made.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oldpar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">1.5</span>,<span class="fl">1.5</span>) +<span class="st"> </span><span class="fl">0.1</span>)
<span class="kw">plot</span>(ecg_wav@W$W1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)
<span class="kw">plot</span>(ecg_wav@W$W2, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)
<span class="kw">plot</span>(ecg_wav@W$W3, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)
<span class="kw">plot</span>(ecg_wav@W$W4, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAflBMVEUAAAAAADoAAGYAOjoAOpAAZmYAZrY6AAA6ADo6AGY6OgA6OpA6ZmY6kJA6kNtmAABmADpmAGZmOpBmZmZmkNtmtv+QOgCQOjqQOmaQkDqQtpCQ2/+2ZgC2kDq225C2/9u2///bkDrbtrbb25Db////tmb/25D//7b//9v///9LzNAhAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dCZucuNWF5Umn287SbSepdpKu5HNluhb+/x/8EKsALVcbXNA588yMLV2uxOEFBAVCVBDEWGLrDkCQTQAUYi0ACrEWAIVYC4BCrAVAIdYCoBBrAVCItQAoxFoAFGItAAqxFgCFWAuAQqwFQCHWAqAQawFQiLUAKMRaABRiLQAKsRYAhVgLgEKsBUAh1gKgEGsBUIi14gEVRSqB9fBTkdmOeEOjM+xQOQHNl5qvAGhiAdC0igX0/vZa3V6EeA7OcDAB0LSKBPTxXvP57VdVXTSEwtDdpOarSEDv3z9aNhtK+yWd49sDC4CmVewR9OdHdZ0D6pUhtGWu2j2gWVvxTx47Br1++Xi8n5pTfYLexC23onJeW66V2pDuYIDWV0nyZP7lI0lv4pZbUTwB9Wu7EECDctsDkliUl3IAGiYAGpjEt0kAGiYAGpgEgAYWe+rQgOZEDoAGFnsKgK4SDUATtxm0BAANio+17dz+xqG5awdAY3N5ZwCgC52fPtv/h/x0DEBT5bYHFAyo/Om4UdAvcwA0VW57QM5iv54ExAPQgDaDlgCgAeXxp/ju1N6f6r1SA9BUue0BJQNaXXCRRFwCgAaUZ7nNRH58EYCmym0PKBnQx3t79MQY1LnEMQFNZH/WMagcfwJQ5xIANKA8zVX89bdfANS5BAANKE8DaHV9+h2AupYAoAHlzpW2jTGluttMF/EbAHUsAUADyp0rbRtjSj3eO0IBqGuJpqZ9oUNKY1h0b/iQuBag1jGmSwBUV6N7aiE6d1fPh8R1ATWMMV0CoLoa7fuac100P8wBUJ1sY0yXAOiy5v5mP4BahwAAdKHaL/MY0yUAqqu5CqE9PHa6vcgD7PQISv1prkBAnX7aBEANNbcX2wlJHgtKO8XHzVpp99OsPQHqmcUsotP3N7Ol9TAAgDozTWXzMzx1qYDWZyXt9IpKAAB1ZVLk9DM0dYmAyl8+co2ZSgQ0p58lAjq8ghAiALpQVj9LBLTZ44NG9ITeFAhoVj+LBFTKNMV3eO6ung+Jq45Bc/nJyiG/LGYRnb7m+OWDE6Bpws1LzJTFz2IBvRpe4grP3dUXCmguP4sEVJ6OtLPTRuXu6gsENKefJQLq+i0+MHdXXx6gWf0sEdAoAdC0AqCamtvLKfjWCABdKqefJQLaPA16Ppme+AzN3dWXB6jbzwzTLx4Z0Mv41Vn/oT0AXcjpZ47pF48MqPwG0v3HLxxBaeHmJTq5/Mwyu90OAA3xsx+Dyl398Y4xKCXcvEQvh5+7AzTNNgwHFLeZvMLNS3Ry+plj+kVOxumLI46gOV9RKBBQt58Zpl/cwDhPP2MArfK9olAkoJW/n7HTLx4e0CrTKwqlAlqt/MrH4QHN9YpCqYAeys+tAS3llY+1AHX4ub95BjYG1PmKQsyMwAUC6n7lwzLVEEs/ORxBbcOlmBmBCwTU/Tu8Zaohln5uDaiU5RUF7Wxte5xZZM0x6KFeoeEAaGV+RSFqRuBSAa2O9AoNB0BtryjEzAhcKqCHeoVma0BdryjEzAhcIqCHe4VmY0C3+S3esNJerfAE9HjPNmx9BI2RWPxhVu9Vntf+lcegQQKg2prm3vFrdfuHMdKZG4AqSuCnqb5IQC/iJEeaT59n73H9EQA1+W/0zUVRCj9N9WnYSpJkvYukr+2I/vzsP+8VAF0qiZ+m+h0A6gmuu+b8/HiXd5Vv33557/IAdKkkfprqCwT0/naqLs/yxt3T58X3AhSALpTGT1N9Tra4Avr9oz0VnaWxxlhH7ryAZjwQpAc0iZ+m+hIBfTt1P7fzPYLuCtAkfprqCwRUPlvT/JrJYQyawFBv4xIDmsZPU32BgMoHlZpfP+qrznr45KdtAfU8DHsmD71ISuKnqT4NiWmKPcHVFxNqmt/az3JMr3sR1q4gQIUHoMKYZV4slqXT+rpCaDpq8d/b6kar+2kuPwag0k25p4e85bU9oIseaAAVffJVAF3dT3P5UQDt3pPxPR9VFEM1FYcHNKefXuU5SVwV0GD5ASqG/+0CUONgQbtAEq0CqB9apvcmvAE12rYOoKLqDzkdBc2/PRU9Z02d6De/EGO0UJgQ4789W6Izashada+c9Me5/o/j3HITQIdgBeo+i7Imff8qJctiG20HqPHKLRFyupY5AHp/i37tOCWgol/CF9CxeFtAU/iprzbDoiv3iO59jwbUFB55BJVPgUe9otAB2mPVATVQ0YPX1Y2VI6BDuOgB7f5WzcrFVFWffK6+pQm0wy6jYK/uBIsGhkiKoUn91NTaAV0Mmo3YLlEUQ7SyVyu5p4GLYqF0fNbomGe6dmIRoenq5G+6VzpcCgR03PxmQIX6rwXQITknQK1+kmZYHk4l3d96HwdzhvOUen4YORijpycHdZWVdoWSQ4mvNCs/9EGoZUMzfZvKaUrZ7GpvlytttsO6x1MMFap9M0BHhkiAzo+eLkDHPXpRblpg3Krj1hJrHUFpMywPe5DCmvK/nsVZhweTZzj3sM+dmB4Opn4ou3Df5NDadPdWujUUjYCOC03DCX72NfYxE9HQiUUGQBdm9IfdCRAWQIVGVkB1C417itrpaUtqfwYinIZS/NROYKv0RCnRrdW4biY/FqGUKE/RGrbXEfwknavIhqbywTdPinZJObxs8/NzmXo83SwIU86+6gleKLvS5AChntvVbJXy/8khoj/dqatuOg6MSSY7fTWLGcKG4yfFz6GmnVLVOnEDxdB+VfUHOvPaVbPVGf+ZB+pyDxtrmdt8CFoeJ5Vw/aneA1Cbn9QZlvshXdX3bTwVKZ5XSn01DhzVYcGYT6iAjp71A8XetL5uiFUyD/+OfRkaGYZKk31LMXPSP2V4aPRxPMWfruY3aGiGagCdbeHJeXQSYQF0mmongNr99JphWUyKOx8XAUPxpI+L6HFYOKI1IFdN13LMpNA3bVLXptqoMJQvWqhMGgD9/nH/8Ut3hGxEMnTY86pKQXUgRdm71HNSFzE5iymmjXv2cBCpZuxUqk1K8WQX7peY9mjCqXrMmFyBLA5FBEDtflpkAHQ0eQFoF6UvNkQvKbQkNyeZA2rKMt2HNKlMFUPN4/30+PkRZ2gIoD2YNED7VuyAKiewYfSlAtrH5AQ0hZ/66sSAUpL7Rft2sa1y1ty+flyD7iwDUK0S+Gmo1wekAtSv2NCXHIAGS+j+0uM4sFUpFePxvoeoB3S2bmL8jwJon12ImUXtH7XFA5fVyFw1K590vwd0SCLUvyWwzahDAOrTxbbKVRM+nVA6QCsHoGPO/k98AU3kp66+TECb6QKDJmQLNXRSLka8XBYJfbFa4+WzUMqn9VPKtTuiRWv7eXhAqyrsW4hJAPUoNgMaVkwDdLEQRav6eXhA5Z2kFSdcPTyga/uZEVBDm3scg+rqmQNaZQH0UGNQDoC2U1YHvEKzOqDJiz03S1tlrBm0tp/rA+odHj0Grc47GIMmL84EqNSafh4eUPn8Io6g03JtcVNlrBm0tp8HBzTBOzSm+iIBXd/PFICaN5aheO1TfK3rSnMJHRzQQav56QWoqRkAqhSvfko6BqAmtACod+6uHoB6CYDaa1YzdH1AjcQBUFdyT4OOAKj3US4+ukRAzevslRyAjqUANCigbEDl989lecj34hkB6teVnICSJm7watsIqFeWHQCqlXxpTr4wxw1QT0O3AFQr2jwDXm0fHdB2Okuhf1G2+yLAb9qXwACoTgQ/q6RnpKMD2u7M9X8uml9AOkOvT78DUGsiRQQ/AairN0pN61ltmPZFxO5UdFGPB6KXMbe9cROgPtF8ASX56Zq4waftrIB62pwD0Gbaf2nYVfcbclurn60NgOpk99Nr4gZqwLEBbS8sn6vbS+rPppQJ6Pp+bgCod1eiAHXK8OFeAJpWAJRYs9AqgHpGJ/LZ0/8sgMaO6fkDarGN4LT8xLl9gmUASqnpZfNzuAeluwkFQLU1j3c5VtLdE3EJgOrk8FN3h56aukxAh9sixkj/3PaAYwPq8FN+bjY0dZmAdjeWcQQlhFtreq3u59EBlc+DiJD3aA4AqG84BdDV/Tw6oMECoIFKfNEJQEMzAFC9ACihYnKK1z4L4tQ6gG5iaOQp3uEnACVUDDX1ZeX16ZPvbaa9Abq+nwcHtN6da0P53mbaG6Dr+3lwQNs9ftXbTH7pdgbo+n4eHNANbjP5pdsZoLjN5KUYp8Nz2wMODmiwAGhcKv8MANRLADQulX8GAOqlYED9ogGoKwCABqYGoKly2wMAaGBqAGqS/rYzAE2rbQH1i+YCaJYnwAFoYGoAutTtRT5fiyMooSZaewI0UXgKp+XrNQCUUBMtABqW6v72PAU0emYRvw7tZVBPU/rZ7XyjDweo/DLVlkfQrMnXBjTD7Ha+0QcENDTDFoB6Rq8MaNzkYX4qCNDU78VHd8hfADSwGQAa0iF/MQE0bnY7PwFQABqgmNnt/JQmXdatYs3Pbgy6iVYHdL3UADQ0AydAvRXZ+aiPUvgJgAJQf+k+SkG+r+wnAApAvRX3UQo/AVAA6q24j1L4aR82cwR010pzm+kS9HTYEQVAEyv6IinioxRHFABNrP3cZtqHAGhipVjp0B8+jqisgBapaNvMgBYpM14JnA5JlfGnYC79cMkAaFhbXFY6eWoAmi86TlwcAqCbpgagzFMD0HzRceLiEADdNDUAZZ4agOaLjhMXhwDopqkBKPPUADRfdJy4OHQcQCEovQAoxFoAFGItAAqxFgCFWAuAQqwFQCHWAqAQawFQiLUAKMRaABRirVSAPt5173jPdXsR4jQEu5dpZt6gRXfTHdGC6358+SAHLztBW9sIkRvwcMjP/KvwsMirH01Hnj6J0akAPT9r57Oe6v52qq71anfB7mXOsuu06PPT5+0rMbXsh3wlnRi87ARpbWNEbUDXOWOoj/nSyyvVosprS1XXtpIWnQhQ+QKYbqKhWc+a/ebUBbuXuf6hrqZFd2+g0YJvbVpS8EX8ZdEJ2tpGiNqArnOmWF/zK7JFldeWqpF87bJTohMB2m1yQmS9I3fBzmUe//xvHUKL7taRFlxvJ7m9SMH/a8KmofS1DRS1AV3nbPEe5lfNd7GI0T5bqnr8bOqI0asDSl/r6vJKt//69B85wqJ69C66yQ8JwYwB1XXOFu1hfj1S/PJBTe2zpeq6Pwl66rUBlUM/6or8zeP4cK2vkOoRFi34/vYqO1IcoB7mS12pFnltqWZ4e/9BdX9lQC/yypDYtfPJw/5uhEUfD9BxOwygPuZLkVfYa0v5pV73IqmbzY142dN+wZY4qpdV5EuAm8dF0kjLjd9Fkq5zxlAf8/tekKL9tpRX6pVvM8mDuxLsXqbpOfE20yv9tsjj/ZV+m0nXCTa3mTwc8jNfenn78yd5hT22lF/qVIDWe5H7znL7hcpTH+xeplltWrS8UX+iBnc36onBy06Q1jZG5AboDnmafxFeK+yxpfxS46dOiLUAKMRaABRiLQAKsRYAhVgLgEKsBUAh1gKgEGsBUIi1ACjEWgAUYi0ACrEWAIVYC4BCrAVAIdYCoBBrAVCItQAoxFoAFGItAAqxFgCFWAuAQqy1J0Cn7/dnndqjCO3CTwBarnbhJwAtV7vwc2eA3r79q5np+yrEH2tD21kp5KRYt5fXrbu3O+3Cz70B+tJMwdTM4f3lQ05Ee3lqZ/lh4ueetAs/9wbo12YuNDnZojJ13+P973UB5Kld+Lk3QNtpKC+doS+i/RbFVc4bBnlqF37uE1Blj5e6f/93ztk6j6pd+LlPQJUxU/23ZrpPNuek/WgXfu4TUDnB51/bq0755R+5/79lnVD2kNqFn3sCFCpQABRiLQAKsRYAhVgLgEKsBUAh1gKgEGsBUIi1ACjEWgAUYi0ACrEWAIVYC4BCrAVAIdYCoBBrAVCItQAoxFoAFGItAAqxFgCFWAuAQqwFQCHWAqAQawFQiLUAKMRaABRiLQAKsRYAhVgLgEKsFQ+oKFKRpp3bLLp5trddr61kxivS6UKPwZErfe5m3zxr5jiEn8Sa+NwHVtxKD198uWkmMoafxJr43AcWAE2raEBtY6awLu1bsaf47tR+1ky0DT+JNaowZpopdqUv2OEnigQ0yylpiw3h26YxPkPn3Re0WypzrwBoWJu5AJWfHPy/dyF0HyoAoAEN5xgzlQzo+dR+K+uymyETc0BzjJkKBlSekZqz0n6u4rkDqlsycsxUOqA/fgFQQnpaw/e3V/mtp6RjpoIBxSmenp7UsPw2XrOzpzS0ZEBxkUROT76Kb9hc4So+qxNcAA1qc1PxBvTx86O6AtCIRCna3FS8Aa2u7Zdw5ak+MAN5OQCaL3WEmAMqB02i/dZ9aAbqcgA0X+oIcQc0KHfQcgA0X+oIAdDYdDFtepcD0NXSA9CQcgC6WnoAGlIOQFdLD0BDygHoaukBaEg5AF0tPQANKQegq6VfAVA/EgFovtQR2hjQ+5t4+t3wtFJ4bnvA8QG9aB7vdospoHm75QL0/FpdJJ26p5XCc9sDDgxo+7ub1G+/iD2ruL+TtCmg1ie8w3PbAw4MaHV7kQ8t4AhKT2+vAaCe5e5eXupjJwClp3fU9C/F7e8U7xe+4hj0/vYMQOnp7TX1mKl5jk730mZEbnvAgQGt4az/exXHAVRk7pbzNtNV2N2MmfqmPEDdfloEQA01txfzNWfU1DclAlrZ/bQJgJpr7m96S+NmFikU0Mrsp1UA1FBTn5VMN+oBaECzFj+tAqCamse7fcwUNfVNgYC6/LQpmIScCG0M6HCENCpm6pvyAHX7aREA1dTIPd53uET+aa48QIP8JKbOsCAp9/ZjUNPUNqP0N54BqF5uP4NTJ16QlHt7QCs5rjdcxdsefgCgRpn8tAqAGmquhjGmlO3hBwCql81PmwCopkaejrSzMgwyP/wAQJdy+pnjoxQHBrT97dgu48MPAHQhp59ZPkpxYEBpMjz8AEC9lec7SUcG9PZyCr41AkCXcvgJQJf5rTXNrHXnU9gz4AB0IaefWT7kdWBAL+NXZ+2XSn657QEHBtTtZ44PeR0YUDn3ZzOpP46gxOyuI2iAn9EvzR0YUHlbpN7VH+8YgxKzu28zEfwMvCsS2Kco7eA2U0Bue8CBAXX5GffLXFif4rT1ETTrKwrlAer0M+qXudA+xWhzQKuMryiUCGjl8jPilzlTl44OaJXrFYVCAa3sfob/Mmfq0tEBzfaKQqGAOv0M/WXO1KUjA5r1FQUTifryQwC6xSsfRwY07ysK5QG6ySsfRwY07ysK5QG6ySsfhwZUKtsrCpwA9Rz4Rl7Fr/rKx+EBrWyvKOSY+ubggFYrv/JxeEBtryhkmfrm4ICu/crHoQF1vKKQZ2aRAwPqfoXGLAC6rHH+dgxAvZrN+2yDabkDA+pUlqlvjgtolACotqZ5wOa1uv1DH5Zj6httua/NSQA1NhoOqMNPi5gCmpdQJ6AXcZJ3754+z+RxfeTUN4Z9MiugpuNAekAD/KSmNi53ZEBvX9tB5vlZ/yOIvPEsnU44Bt0DoObOuC6SHH7adAhAffviAvT8XCP43ACo3eXlGFSOP0MANY41Dwyoy0+bAOiy5v52qi7P8sbd06fuQx/tYeD62y8ASmrW5adViS8602hrQL9/tAyeT9ov0XTnqevT79wA9QtfDVCHn4bGIqezPDKgb6fuIGnY47vbTJeQd2hKBNTlp03BgGa+97UloHKigYZB05jp8d4RCkD7TDY5/bQJgGpq6uFl8+tHfdVZD59S5e7qywM0q5/7ADTZpURb0xwhz3JM7/+xOQC6VE4/fQH1NNRYvCmg0k25p4e8NZcY0JxGrAZoTj8LBbSbTMD3fGTN3dUXCejqfh4e0GAB0LQCoMSa+NxdPQD1UnJAU1x+bw/o/S3Xa7JlArq6n1kBFcYaU5oMR1D5FHiOVxT2AKj3tiU0u7KfgYDOKi0P6W4OqJTuRnx47q4+EaD6cL6ASuX0cx7Xr8SiPATQebG9X8uqEo+gewM0t59+gBJdTQsofVMeYQzqB6hX8gyA5vfTAOi8z30xrbVkgFoXCQE0XAA0rZx+mkBcloux3DRwTQGoxqYMgF5MM/66RDQ0rtgEC19AE/lp2vaegFLvU9gBFfMyXRIxdHJqqyle156m5v52uoa8QQNA9UrlpxnQZeCiXAGUyMoAqKYXYlqqNrMotwO6XCsCoN8/7j+0T8y7BEB1SuXnsgt2QNXjnBjopAE6Hmk1yeeAKn+eRIuxd0kBfbyfHj8/EgBqMtRUvFhcaLNU+lENW0BT+ZkUUDHG6tILW/K2UEvZFFDDXmGKn/fIWHP7+nENui9CNNRU7AZU2akX2R0HXH3yWZm5L0JbbCiaye4neTK2ZZcH1siA9mgNqzkHdCzWADqQ7QfoLDweULvohk62qW3ra9Zacchw0liekdQmZv0Q8yy66wtl+eWATFusWRlfkSZjU3kTU4+MgI5r06+uFdDJkU50HlVjpNKNaqytpiHTriwAFfP4MEDt0wnRDBUjQiOgQodc1dthBbT/U1csFIdE52bnwXL0LoQYAOuXWCbvQvoNqO5WzeJiWEp31WCT1U/tXFfLl+aEsrGrrj9TQMXEh5EMMdImJusuFBuGvH3jM0BHb6a2CSXzkHwMVxvtt5u6dygrM9lTDBprruYJ2YiGDk6I0SMxHOR6JKvBUtFveqH6MxaOK9f/edzNu3/ULTFw3PeuGjpTjdFj+0OlGNIpVIy9GrJPDz0u+fqpSa2eHyYXHyqjVd//Yf8bd6kFoOpBYP6XcRGV9xFQZTsOf65m7cwand4V6DfMtNH5SpvtqIzf7qPPbqeCokA6GN07OMKn+tpjOpyfB68H8pSqSozlQvlnemztM1fDQVXBVQz/UYxTdoXZXkMxlOIneTK28Rg2xaEvUHaYKaD9Amqowor6R3WtVPqXOCl7iwrorCuTDgslcyygF8MYU8pndrvZ3jllSzmyjQc0ZUExHmZnSdWo/o/DoXpi+7CbVKoxfXKh1A77/bSL4/YbTl9zTwmA2vykTsYmhK5kBqKtXGVlAaiolOK+ZAqomkRFc+yX4rOm0claKb0zQbNUX+OY0tJjdrv5vqFlq6rE6Ngs2g7oNLc+XIF1mXxy2BBD+dzyatiZqukG1vROo/ApQhfbVbNuVkA1B7NJKQlQtXza0KxfZkD1a6bburQj6DXsFRrXthKG7orpSinRWhTNgGp6IfS9MiY37RVmJglH0Fx+KiDOAV16oQO0mlAyd0QD6PTPsz+uB6jUOf1v8RZADdF0QE3JgwGdl8cAKpXBzyo1oMvmF+Vad8zA2QDVHU80f9fVyOcX1z2CGqKZAjpvwaVMflbaU3m7zlZAl23EAqoQ5wuovkO2mmzPL24DqDF6LUDzPQ+aAlCFwTSAzsozADromnguoayAmrJsD+ig1H5WBkArLRc2tIwHV00aYxaT0aZG+QFqPsvkA9TgkHFfMYNrEgtACUsC0LUANa5YAkCr4wJqBYK+XQDoUApAOQJq7IgXoMZ4poBqSw2smFcMgIZkA6BqvSdxANQZAUA9BECtOjagfrwlAdRbADStVgHUzApXQNvpLEXAi7LHBTRmv87nJyNA7XexfHITnG6eqKv/c/H9BWQ/gFrsSQ5oPj89GTK3si9A22eSb9/835SlGEpfzJsVpoBm9TPBACMRoL6NhgPafmjm/PR5zbHH0xdLA6hXaVOTGtCsfpYIaPvi5nN1e0n+2ZQiAfX3U/eOV3jrhBR7AzRUADSt9gSod6uHANSvFQAa2soGgBpFcFp+4jxkQmCegPrGpgc0o59FAvp4l2Ml73si1tzWiCSHRFLzlNgMF0n5/MwKaJJLMG+5nR5uiyTMbY1IQpxnuC9wEYDm9LNIQLsby2yPoBHNU2KTA5rTzzIBfbwL+fFTj5zk2yJFAurtJz11mYBmyG2NODqgwVoHUPPF0BZ8AlBXLABNmtxbtFP80+8BY3oAqldGP4sE9PH+en365HubKaJ5SmxyQHP6WSSg9+8ftaG4zRQVryinn0UC2u7xK95mShSdyM9MR1Cjn+Qp1cNaJ2hvgOa8LVIioHY/SVOqm1UkoBlyh7XBCNBcrdJnrM4nABraBgBdRQA0tI0CAPWaUj2TAGhoGyUA6jOleiZt81idSQA0cZaMGxeAEmvic4e1UQ6g+tv4AJRYE587rI0CAB1mdVCndfB4aS6FNnloySgAmjhLZKu3Fzn63PYICkATtpE9+eqnePm6EgAdBEATZ4lv9f72DEAHAdDEWVK0etX/EgpAiTUTRT3cAECZpN6kHZJiAY17uGEHgG7R6vCDZ/rUFB0J0MjfjgGoVgB0FABl2CoAHRV9io96uAGAMkm9STskRV8kbf9wg0kAlHk7JG17mymrACjzdkhKA+imN5ZNAqDM2yEp9iKJwcMNJgFQ5u2QFHsEZfBwAy8dAFBWij/Fb/5wAy8B0LRKMAbd+uEGXgKgaZXkImnbhxt4CYCmVdbbTEUq2jb4OZHZDrpzhp/mAjL5Ru8zdZxITVGCkiVauTX/WAAKQFdszT8WgALQFVsLiE2ZiQtFAJRrawGxKTNxoQiAcm0tIDZlJi4UAVCurQXEpszEhSIAyrW1gNiUmbhQBEC5thYQC0GrC4BCrAVAIdYCoBBrAVCItQAoxFoAFGItAAqxFgCFWAuAQqwFQCHWSgTo412d08Gq20vzkVXKEs1kel2gO76JpmWXUSdy6i7ao+OxIqzsZA2MUd+cqyc/evvqCqpb+/JhDSJtqmELuXs+KBGg52ft5LY6XZ+pS9zf5Cp0gc74NpqU/f52qq6147TUfTS949EirOxkDYx5FANNIU+ft6+ORLI1OTGCOYi0qZogYs8HpQFUvg2imztUp/MrcYmL+Esd0AU649toWvZrcyA8EVN30fSOR8vdxnQNjFF/GA20NOVs8damMQeRNlUbROv5qBlmVEMAAAK7SURBVDSAdmtACX38/CAu8b9PGdQFOuPbaHr2ek+mpm6j6amjRWtjXANDwOOf/x0NtDTlbFHunjVY5iDSpmqDSD1XtDqg9+9/kuMZ0hI+gPadoGa/DIZTulJH+3Q8UrQ2LjZkmoDXmxPQ69N/5JDQ0WI9YKwPfLYg0qbqAXX2XNHqgMoBz/3Hr0yAkrPLIRU9dRPt0fFIkdpQ1kAfcP/bJwHQ+gqpHhLag+5vr7K5VIA6e65qdUCliIetAECp2S/yopScuon26XikSMd0ZQ30EedTRQC0HRK6xwGOVfcA1N1zVetfJLXhpCX6taBcJE0AdUVfmjsc5Ouv4X4IteORolxBqmugT9JO6uq4HGkG7q5rFudFEnFTNaXunk+0+m2mqzy+//mTtESzBtTbTE00Lbs8Wyu9dqTuon06HitnG7M1MIYpBpqaem3WzBr0eH913Gaibap+EEbo+aBEgNa7K/Xu9aWdp5myRLPWXaA7vt0/Kdnb7+adiKn7aI+Ox8rZxmwNTFINNEjeqD+5grob9ZYg0qaSQcSeD8JPnRBrAVCItQAoxFoAFGItAAqxFgCFWAuAQqwFQCHWAqAQawFQiLUAKMRaABRiLQAKsRYAhVgLgEKsBUAh1gKgEGsBUIi1ACjEWgAUYi0ACrEWAIVYa0+ATl/0zz29x/G1Cz8BaLnahZ8AtFztws+dAXr79q9mxuqrEH+sDW2np5CzUd1eXrfu3u60Cz/3BuhLM5VQMyf1lw85serlqZ0uiYmfe9Iu/NwboF+bSdHkpIHKRH+P97/XBZCnduHn3gBtp6G8dIa+CNHManWV819BntqFn/sEVNnjpe7f/515xs5Dahd+7hNQZcxU/62ZvpLNOWk/2oWf+wRUTlj51/aqU35yR+7/b7knlT2eduHnngCFChQAhVgLgEKsBUAh1vp/hU/GzS3yT9MAAAAASUVORK5CYII=" title alt style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(oldpar)</code></pre></div>
<p>The detail coefficients of the first level contain more noise than those of the second level, which was the single reason of choosing level 2 coefficients. Detail coefficients of the third and fourth level contain too much detail and are missing vital information about heart beats, which is why they are less appropriate for heart beat detection than level 2 coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oldpar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">1.5</span>,<span class="fl">1.5</span>) +<span class="st"> </span><span class="fl">0.1</span>)
<span class="kw">plot</span>(ecg_wav@V$V1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)
<span class="kw">plot</span>(ecg_wav@V$V2, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)
<span class="kw">plot</span>(ecg_wav@V$V3, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)
<span class="kw">plot</span>(ecg_wav@V$V4, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(oldpar)</code></pre></div>
<p>The plots of approxiation coefficients show, how the signal is gradually lossing in detail from <code>V1</code> to <code>V4</code> and that it is getting less appropriate for heart beat analysis along the way.</p>
</div>
<div id="peak-detection" class="section level3">
<h3>Peak detection</h3>
<p>As mentioned, coefficients <code>W2</code> are used for heart beat detection. Heart beats are determined by detecting the <a href="https://en.wikipedia.org/wiki/Electrocardiography">R points</a>, maxima (or peaks) of the <a href="https://en.wikipedia.org/wiki/QRS_complex">QRS complexes</a>. Firstly, each data point is being checked if it is a local maximum (peak) and if it is greater than a preselected fixed threshold. Before going through the loop and checking these conditions, a vector of zeros <code>R</code> is pre-allocated for detected R peaks. The length of the pre-allocated vector is equal to the length of the ECG signal. All R peaks detected during the <code>for</code> loop are written to this vector as the index/location of detection. After detection is finished, all the (remained) zeros are deleted from the vector <code>R</code>. It’s length is now equal to the number of detected R peaks/heart beats in the input ECG data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Coefficients of the second level of decomposition are used for R peak detection.</span>
x &lt;-<span class="st"> </span>ecg_wav@W$W2

<span class="co"># Empty vector for detected R peaks</span>
R &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="kw">length</span>(x))

<span class="co"># While loop for sweeping the L2 coeffs for local maxima.</span>
i &lt;-<span class="st"> </span><span class="dv">2</span>
while (i &lt;<span class="st"> </span><span class="kw">length</span>(x)-<span class="dv">1</span>) {
  if ((x[i]-x[i<span class="dv">-1</span>]&gt;=<span class="dv">0</span>) &amp;&amp;<span class="st"> </span>(x[i<span class="dv">+1</span>]-x[i]&lt;<span class="dv">0</span>) &amp;&amp;<span class="st"> </span>x[i]&gt;thr) {
    R[i] &lt;-<span class="st"> </span>i
  }
  i &lt;-<span class="st"> </span>i<span class="dv">+1</span>
}

<span class="co"># Clear all zero values from R vector.</span>
R &lt;-<span class="st"> </span>R[R!=<span class="dv">0</span>]
<span class="kw">str</span>(R)</code></pre></div>
<pre><code>##  num [1:9] 53 105 155 206 257 308 359 411 463</code></pre>
</div>
<div id="determining-heart-beats" class="section level3">
<h3>Determining heart beats</h3>
<p>In total, 9 heart beats were detected, which seems correct according to the first figure. However, the indexes seem to be incorrect and to small. This is because the detection was performed on the level 2 detail coefficients. To remind, the number of samples is halved in each level, which means that number of samples in level 2 coefficients was halved twice (or divided by four in other words). Therefore, to obtain the equivalent indexes of samples in the input ECG data, the result in <code>R</code> has to be multiplied by 4</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Rtrue &lt;-<span class="st"> </span>R*<span class="dv">4</span>
<span class="kw">str</span>(Rtrue)</code></pre></div>
<pre><code>##  num [1:9] 212 420 620 824 1028 ...</code></pre>
<p>It is possible that the properly scaled results can be off the real R peak mark for a few samples. That is why they are checked out on the input signal in a <code>for</code> loop. Each detected R peak is used as a center of a time window with width of 21 samples (84 ms), where the true local maximum is looked for. This gurantees that the real R peaks are found and used for later calculations of inter beat intervals. The line right after the <code>for</code> loop ensures that there are no duplicate heart beats. This code chunk is concluded by writing to vector <code>Rtrue_idx</code> the indexes corresponding to the detected heart beats from the ECG data frame <code>df</code> (because there may be differences if <code>NA</code> values are present in the input data).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Checking results on the original signal</span>
for (k in <span class="dv">1</span>:<span class="kw">length</span>(Rtrue)){
  if (Rtrue[k] &gt;<span class="st"> </span><span class="dv">10</span>){
    Rtrue[k] &lt;-<span class="st"> </span>Rtrue[k]-<span class="dv">10</span>+(<span class="kw">which.max</span>(X[(Rtrue[k]-<span class="dv">10</span>):(Rtrue[k]+<span class="dv">10</span>)]))-<span class="dv">1</span>
  } else {
    Rtrue[k] &lt;-<span class="st"> </span><span class="kw">which.max</span>(X[<span class="dv">1</span>:(Rtrue[k]+<span class="dv">10</span>)])
  }
}

Rtrue &lt;-<span class="st"> </span><span class="kw">unique</span>(Rtrue)
<span class="kw">str</span>(Rtrue)</code></pre></div>
<pre><code>##  num [1:9] 208 414 615 819 1024 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Rtrue_idx &lt;-<span class="st"> </span>df$idx[Rtrue]
<span class="kw">str</span>(Rtrue_idx)</code></pre></div>
<pre><code>##  int [1:9] 208 414 615 819 1024 1227 1430 1639 1846</code></pre>
<p>With this the heart beat detection is complete. The remaining code of the function calculates the inter beat intervals, exact times of heart beats for a potential HRV analysis and prepares the final output.</p>
</div>
<div id="calculate-r-r-intervals" class="section level3">
<h3>Calculate R-R intervals</h3>
<p>Inter beat intervals or R-R intervals are calculated from the indexes of the detected heart beats <code>Rtrue_idx</code>. The R-R intervals are calculated in number of samples (<code>RtoR</code>) as well as in seconds (<code>RtoR_sec</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Determine R-R intervals in samples and seconds and average heart rate.</span>
RtoR &lt;-<span class="st"> </span>Rtrue_idx[-<span class="dv">1</span>] -<span class="st"> </span>Rtrue_idx[<span class="dv">1</span>:<span class="kw">length</span>(Rtrue_idx) -<span class="st"> </span><span class="dv">1</span>]
<span class="kw">str</span>(RtoR)</code></pre></div>
<pre><code>##  int [1:8] 206 201 204 205 203 203 209 207</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RtoR_sec &lt;-<span class="st"> </span>(ecg$time[Rtrue_idx[-<span class="dv">1</span>]] -<span class="st"> </span>ecg$time[Rtrue_idx[<span class="dv">1</span>:<span class="kw">length</span>(Rtrue_idx) -<span class="st"> </span>
<span class="st">    </span><span class="dv">1</span>]])/<span class="dv">1000</span>
<span class="kw">str</span>(RtoR_sec)</code></pre></div>
<pre><code>##  num [1:8] 0.824 0.814 0.814 0.811 0.813 0.819 0.828 0.824</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Average heart rate of the input ECG signal</span>
avgHR =<span class="st"> </span><span class="dv">60</span>/<span class="kw">mean</span>(RtoR_sec)
avgHR =<span class="st"> </span><span class="kw">as.integer</span>(avgHR)
avgHR</code></pre></div>
<pre><code>## [1] 73</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the original signal together with results</span>
<span class="kw">require</span>(ggplot2)
<span class="kw">ggplot</span>(<span class="dt">data =</span> ecg, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> ecg)) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> ecg[Rtrue_idx, 
    ], <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> ecg), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" title alt style="display: block; margin: auto;" /></p>
</div>
<div id="heart-beat-tachogram" class="section level3">
<h3>Heart beat tachogram</h3>
<p>The function also prepares input data for (potential) HRV analysis, which can be performed with the <a href="http://rhrv.r-forge.r-project.org/"><code>RHRV</code> package</a> in R. HRV analysis functions in <code>RHRV</code> package require the heart beat data to be written in an ASCII file as a tachogram (a time series of exact moments of heart beats in seconds). The heart beat tachogram is obtained from the <code>time</code> column of the <code>ecg</code> data frame as the elapsed time in seconds from the first sample. The heart beat tachogram is saved as single column ASCII file <code>Rsec_data</code> to the current work directory</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Write the information about detected R peaks to Rsec_data ascii file</span>
Rtrue_sec =<span class="st"> </span>(ecg$time[Rtrue_idx] -<span class="st"> </span>ecg$time[<span class="dv">1</span>])/<span class="dv">1000</span>;
Rtrue_sec &lt;-<span class="st"> </span><span class="kw">round</span>(Rtrue_sec, <span class="dv">3</span>)
Rtrue_sec</code></pre></div>
<pre><code>## [1] 0.833 1.657 2.471 3.285 4.096 4.909 5.728 6.556 7.380</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write</span>(Rtrue_sec,<span class="st">&quot;Rsec_data.txt&quot;</span>, <span class="dv">1</span>)</code></pre></div>
</div>
<div id="preparing-and-saving-output" class="section level3">
<h3>Preparing and saving output</h3>
<p>Vectors <code>Rtrue_idx</code>, <code>Rtrue_sec</code>, <code>RtoRext</code>, <code>RtoR_secext</code> with information about the detected heart beats is merged into a data frame <code>Rall</code> which is exported as a text file <code>Rall_data.txt</code> to the current work directory. Vectors <code>RtoRext</code> and <code>RtoR_secext</code> are equal to <code>RtoR</code> and <code>RtoR_sec</code>, respectively. They are just padded with a leading zero to equalize their lengths with the lengths of <code>Rtrue_idx</code> and <code>Rtrue_sec</code> for data frame construction</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RtoRext &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,RtoR)
RtoR_secext &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,RtoR_sec)
Rall &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Rtrue_idx,Rtrue_sec,RtoRext,RtoR_secext)
<span class="kw">str</span>(Rall)</code></pre></div>
<pre><code>## 'data.frame':    9 obs. of  4 variables:
##  $ Rtrue_idx  : int  208 414 615 819 1024 1227 1430 1639 1846
##  $ Rtrue_sec  : num  0.833 1.657 2.471 3.285 4.096 ...
##  $ RtoRext    : num  0 206 201 204 205 203 203 209 207
##  $ RtoR_secext: num  0 0.824 0.814 0.814 0.811 0.813 0.819 0.828 0.824</code></pre>
<p>Finally, the function returns all the results together with the input data as a list</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">signal =</span> df, <span class="dt">coeff =</span> x, <span class="dt">R =</span> R, <span class="dt">Rall =</span> Rall))</code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
